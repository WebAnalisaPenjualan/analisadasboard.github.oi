<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Dashboard Analisis Penjualan & Pencapaian Target Kendaraan</title>
  <!-- Tailwind CSS -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- jQuery (untuk DataTables) -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <!-- DataTables CSS & JS -->
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css"/>
  <script type="text/javascript" src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
  <!-- SheetJS (XLSX) -->
  <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
</head>
<body class="bg-gray-100">
  <!-- Navbar -->
  <nav class="bg-white shadow">
    <div class="container mx-auto px-4 py-4 flex justify-between items-center">
      <div class="text-xl font-bold">Dashboard Analisis Penjualan</div>
      <div>
        <!-- HAPUS: Link Tren Penjualan di navbar -->
        <a href="#ringkasan" class="px-3 py-2 text-gray-700 hover:text-blue-500">Ringkasan Penjualan ðŸ“Š</a>
        <a href="#strategi" class="px-3 py-2 text-gray-700 hover:text-blue-500">Strategi Optimalisasi ðŸš€</a>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="bg-blue-500 text-white py-12">
    <div class="container mx-auto px-4">
      <h1 class="text-3xl md:text-5xl font-bold mb-4">
        Dashboard Analisis Penjualan & Pencapaian Target Kendaraan
      </h1>
      <p class="text-lg md:text-2xl">
        Ringkasan performa penjualan berdasarkan data transaksi
      </p>
    </div>
  </section>

  <!-- Main Content -->
  <main class="container mx-auto px-4 py-8">
    <!-- Upload Data Excel -->
    <section id="upload" class="mb-8">
      <h2 class="text-2xl font-semibold mb-4">Upload Data Excel</h2>
      <form id="uploadForm" class="mb-4">
        <input type="file" id="excelFile" class="border p-2" accept=".xlsx, .xls">
        <button type="submit" class="bg-blue-500 text-white px-4 py-2 ml-2">Upload</button>
      </form>
      <p class="text-gray-600">
        Pastikan file Excel memiliki sheet <strong>"Penjualan"</strong> dan <strong>"Target"</strong> sesuai format.
      </p>
    </section>

    <!-- Ringkasan Penjualan -->
    <section id="ringkasan" class="mb-12">
      <h2 class="text-2xl font-semibold mb-4">ðŸ“Š Ringkasan Penjualan</h2>
      <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
        <!-- Card: Total Unit Terjual -->
        <div class="bg-white shadow rounded p-4">
          <h3 class="font-bold">Total Unit Terjual</h3>
          <p id="totalUnit" class="text-2xl mt-2">0</p>
        </div>
        <!-- Card: Total Margin Penjualan -->
        <div class="bg-white shadow rounded p-4">
          <h3 class="font-bold">Total Margin Penjualan</h3>
          <p id="totalMargin" class="text-2xl mt-2">0</p>
        </div>
        <!-- Card: Total Sisa Margin -->
        <div class="bg-white shadow rounded p-4">
          <h3 class="font-bold">Total Sisa Margin</h3>
          <p id="totalSisaMargin" class="text-2xl mt-2">0</p>
        </div>
        <!-- Card: Total Diskon Internal -->
        <div class="bg-white shadow rounded p-4">
          <h3 class="font-bold">Total Diskon Internal</h3>
          <p id="totalDiskonInternal" class="text-2xl mt-2">0</p>
        </div>
        <!-- Card: Total Diskon Eksternal -->
        <div class="bg-white shadow rounded p-4">
          <h3 class="font-bold">Total Diskon Eksternal</h3>
          <p id="totalDiskonEksternal" class="text-2xl mt-2">0</p>
        </div>
        <!-- Card: Potensi Revenue Eksternal -->
        <div class="bg-white shadow rounded p-4">
          <h3 class="font-bold">Potensi Revenue Eksternal</h3>
          <p id="potensiRevenueEksternal" class="text-2xl mt-2">0</p>
        </div>
        <!-- Card: Potensi Revenue Leasing -->
        <div class="bg-white shadow rounded p-4">
          <h3 class="font-bold">Potensi Revenue Leasing</h3>
          <p id="potensiRevenueLeasing" class="text-2xl mt-2">0</p>
        </div>
        <!-- Card: Model Terlaris & Cabang Terbaik -->
        <div class="bg-white shadow rounded p-4">
          <h3 class="font-bold">Model Terlaris</h3>
          <p id="modelTerlaris" class="text-2xl mt-2">-</p>
          <h3 class="font-bold mt-4">Cabang Terbaik</h3>
          <p id="cabangTerbaik" class="text-2xl mt-2">-</p>
        </div>
        <!-- Card: Metode Pembayaran -->
        <div class="bg-white shadow rounded p-4">
          <h3 class="font-bold">Metode Pembayaran</h3>
          <p id="pembayaranCash" class="text-lg mt-2">Cash: 0</p>
          <p id="pembayaranKredit" class="text-lg mt-2">Kredit: 0</p>
        </div>
      </div>
    </section>

    <!-- (HAPUS) Bagian "Tren Penjualan" sudah dihapus -->

    <!-- Strategi Optimalisasi -->
    <section id="strategi" class="mb-12">
      <h2 class="text-2xl font-semibold mb-4">ðŸš€ Strategi Optimalisasi</h2>
      <div class="bg-white shadow rounded p-4">
        <p>Rekomendasi strategi berdasarkan analisis data:</p>
        <ul class="list-disc ml-6 mt-2">
          <li>Tingkatkan performa cabang dengan pencapaian target rendah.</li>
          <li>Berikan insentif untuk model kendaraan dengan margin tinggi.</li>
          <li>Sesuaikan strategi pemasaran berdasarkan tren metode pembayaran dan waktu transaksi.</li>
        </ul>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="bg-gray-800 text-white py-6">
    <div class="container mx-auto px-4 text-center">
      <p>&copy; 2025 Perusahaan Otomotif. All rights reserved.</p>
      <div class="mt-2">
        <a href="#" class="mx-2 hover:text-blue-400">Facebook</a>
        <a href="#" class="mx-2 hover:text-blue-400">Twitter</a>
        <a href="#" class="mx-2 hover:text-blue-400">Instagram</a>
      </div>
      <p class="mt-2 text-sm">Sumber data & informasi: Sistem Internal Perusahaan</p>
    </div>
  </footer>

  <!-- Script: Parsing Excel, Perhitungan, dan Update Tampilan -->
  <script>
    // Tidak ada trenChart atau diskonChart di sini, karena "Tren Penjualan" sudah dihapus
    document.getElementById('uploadForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const fileInput = document.getElementById('excelFile');
      const file = fileInput.files[0];
      if (!file) return alert("Silakan pilih file Excel terlebih dahulu.");

      const reader = new FileReader();
      reader.onload = function(e) {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, { type: 'array' });
        
        // Cek sheet "Penjualan" jika diperlukan
        const penjualanSheet = workbook.Sheets['Penjualan'];
        if (!penjualanSheet) {
          return alert("Sheet 'Penjualan' tidak ditemukan dalam file.");
        }

        // Contoh: parsing data penjualan
        const penjualanData = XLSX.utils.sheet_to_json(penjualanSheet, { header: 1, defval: "" });
        console.log("Data Penjualan:", penjualanData);

        // Di sini Anda bisa menambahkan logika untuk ringkasan penjualan
        // (mirip seperti di code sebelumnya, tapi tanpa tren penjualan)

      };
      reader.readAsArrayBuffer(file);
    });
  </script>
</body>
</html>
